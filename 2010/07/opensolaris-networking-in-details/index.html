<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>OpenSolaris Networking In Details - The Pensieve - Masoud Kalali&#39;s Blog</title><meta name="Description" content="Masoud Kalali&#39;s personal blog. Covering subjects ranging from tech strategy, leadership, software architecture, cloud native, and software development in general."><meta property="og:title" content="OpenSolaris Networking In Details" />
<meta property="og:description" content="Introduction In this chapter we are going to cover basic networking capabilities of OpenSolaris. While we will some of common utilities in the recipes, we will learn some more trivial ones here.
Learning netstat command The netstat command is well known for checking the active connections status in a system but it can provide a fair deal of other diagnostics. Following sample command shows some of the netstat use cases." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kalali.blog/2010/07/opensolaris-networking-in-details/" /><meta property="og:image" content="https://kalali.blog/img/avatar.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2010-07-09T00:00:00+00:00" />
<meta property="article:modified_time" content="2010-07-09T00:00:00+00:00" /><meta property="og:site_name" content="My cool site" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://kalali.blog/img/avatar.jpg"/>

<meta name="twitter:title" content="OpenSolaris Networking In Details"/>
<meta name="twitter:description" content="Introduction In this chapter we are going to cover basic networking capabilities of OpenSolaris. While we will some of common utilities in the recipes, we will learn some more trivial ones here.
Learning netstat command The netstat command is well known for checking the active connections status in a system but it can provide a fair deal of other diagnostics. Following sample command shows some of the netstat use cases."/>
<meta name="application-name" content="The Pensieve - Masoud Kalali&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="The Pensieve - Masoud Kalali&#39;s Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://kalali.blog/2010/07/opensolaris-networking-in-details/" /><link rel="prev" href="https://kalali.blog/2010/06/introducing-nio-2-jsr-203-part-3-file-system-attributes-and-permissions-support-in-nio-2/" /><link rel="next" href="https://kalali.blog/2010/07/managing-and-administrating-opensolaris-zones/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><meta name="google-site-verification" content="cDJVSx1L3UB6AwrPKeSQszOyhtjHYvPYkDxZw_Me4Z4" /><meta name="msvalidate.01" content="cDJVSx1L3UB6AwrPKeSQszOyhtjHYvPYkDxZw_Me4Z4" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "OpenSolaris Networking In Details",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/kalali.blog\/2010\/07\/opensolaris-networking-in-details\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/kalali.blog\/img\/preview.png",
                            "width":  1027 ,
                            "height":  833 
                        }],"genre": "posts","keywords": "Solaris, Networking, OpenSolaris","wordcount":  5786 ,
        "url": "https:\/\/kalali.blog\/2010\/07\/opensolaris-networking-in-details\/","datePublished": "2010-07-09T00:00:00+00:00","dateModified": "2010-07-09T00:00:00+00:00","license": "This work is licensed under a Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)","publisher": {
            "@type": "Organization",
            "name": "Masoud Kalali"},"author": {
                "@type": "Person",
                "name": "Masoud Kalali"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="auto" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="The Pensieve - Masoud Kalali&#39;s Blog">The Pensieve - Masoud Kalali&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Blog posts"> Posts </a><a class="menu-item" href="/tags/" title="All the blog tags"> Tags </a><a class="menu-item" href="/categories/" title="List of all categories I blogged bout"> Categories </a><a class="menu-item" href="/about/" title="About Masoud Kalali, Author"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="The Pensieve - Masoud Kalali&#39;s Blog">The Pensieve - Masoud Kalali&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="Blog posts">Posts</a><a class="menu-item" href="/tags/" title="All the blog tags">Tags</a><a class="menu-item" href="/categories/" title="List of all categories I blogged bout">Categories</a><a class="menu-item" href="/about/" title="About Masoud Kalali, Author">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">OpenSolaris Networking In Details</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://www.linkedin.com/in/masoudkalali/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Masoud Kalali</a></span>&nbsp;<span class="post-category">included in <a href="/categories/solaris/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Solaris</a>&nbsp;<a href="/categories/old-blog-migrated-content/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Old Blog Migrated Content</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2010-07-09">2010-07-09</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;5786 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;28 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#learning-netstat-command">Learning netstat command</a></li>
    <li><a href="#learning-ping-command">Learning ping command</a></li>
    <li><a href="#learning-traceroute-command">Learning traceroute command</a></li>
  </ul>

  <ul>
    <li><a href="#getting-ready">Getting ready</a></li>
    <li><a href="#how-to-do-it">How to do it&hellip;</a></li>
    <li><a href="#how-it-works">How it works&hellip;</a></li>
    <li><a href="#theres-more">There&rsquo;s more&hellip;</a>
      <ul>
        <li><a href="#getting-information-for-an-specific-network-interface">Getting information for an specific network interface</a></li>
        <li><a href="#other-commands-for-listing-network-interfaces">Other commands for listing network interfaces</a></li>
      </ul>
    </li>
    <li><a href="#see-also">See also</a></li>
  </ul>

  <ul>
    <li><a href="#getting-ready-1">Getting ready</a></li>
    <li><a href="#how-to-do-it-1">How to do it&hellip;</a></li>
    <li><a href="#how-it-works-1">How it works&hellip;</a></li>
    <li><a href="#theres-more-1">There&rsquo;s more&hellip;</a></li>
    <li><a href="#see-also-1">See also</a></li>
  </ul>

  <ul>
    <li><a href="#getting-ready-2">Getting ready</a></li>
    <li><a href="#how-to-do-it-2">How to do it&hellip;</a></li>
    <li><a href="#how-it-works-2">How it works&hellip;</a></li>
    <li><a href="#theres-more-2">There&rsquo;s more&hellip;</a></li>
    <li><a href="#see-also-2">See also</a></li>
  </ul>

  <ul>
    <li><a href="#getting-ready-3">Getting ready</a></li>
    <li><a href="#how-to-do-it-3">How to do it&hellip;</a></li>
    <li><a href="#how-it-works-3">How it works&hellip;</a></li>
    <li><a href="#see-also-3">See also</a></li>
  </ul>

  <ul>
    <li><a href="#getting-ready-4">Getting ready</a></li>
    <li><a href="#how-to-do-it-4">How to do it&hellip;</a></li>
    <li><a href="#how-it-works-4">How it works&hellip;</a></li>
    <li><a href="#theres-more-3">There&rsquo;s more&hellip;</a></li>
    <li><a href="#see-also-4">See also</a></li>
  </ul>

  <ul>
    <li><a href="#getting-ready-5">Getting ready</a></li>
    <li><a href="#how-to-do-it-5">How to do it&hellip;</a></li>
    <li><a href="#how-it-works-5">How it works&hellip;</a></li>
    <li><a href="#see-also-5">See also</a></li>
  </ul>

  <ul>
    <li><a href="#getting-ready-6">Getting ready</a></li>
    <li><a href="#how-to-do-it-6">How to do it&hellip;</a></li>
    <li><a href="#how-it-works-6">How it works&hellip;</a></li>
    <li><a href="#see-also-6">See also</a></li>
  </ul>

  <ul>
    <li><a href="#getting-ready-7">Getting ready</a></li>
    <li><a href="#how-to-do-it-7">How to do it&hellip;</a></li>
    <li><a href="#how-it-works-7">How it works&hellip;</a></li>
    <li><a href="#see-also-7">See also</a></li>
  </ul>

  <ul>
    <li><a href="#getting-ready-8">Getting ready</a></li>
    <li><a href="#how-to-do-it-8">How to do it&hellip;</a></li>
    <li><a href="#how-it-works-8">How it works&hellip;</a></li>
    <li><a href="#see-also-8">See also</a></li>
  </ul>

  <ul>
    <li><a href="#getting-ready-9">Getting ready</a></li>
    <li><a href="#how-to-do-it-9">How to do it&hellip;</a></li>
    <li><a href="#see-also-9">See also</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="introduction">Introduction</h1>
<p>In this chapter we are going to cover basic networking capabilities of
OpenSolaris. While we will some of common utilities in the recipes, we
will learn some more trivial ones here.</p>
<h2 id="learning-netstat-command">Learning netstat command</h2>
<p>The netstat command is well known for checking the active connections
status in a system but it can provide a fair deal of other diagnostics.
Following sample command shows some of the netstat use cases.</p>
<p>List all ports:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> netstat -a <span class="se">\|</span> more</span></span></code></pre></td></tr></table>
</div>
</div>
Inspecting an interface:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> netstat -I e1000g0</span></span></code></pre></td></tr></table>
</div>
</div>
Viewing the routing table:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> netstat -rn</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h2 id="learning-ping-command">Learning ping command</h2>
<p>We can use ping, which uses <strong>Internet Control Message Protocol (ICMP)</strong>
packets, to check whether a target address is accessible or not. For
example to check whether 10.0.2.24 is accessible for us, we can use
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ping 10.0.2.24</span></span></code></pre></td></tr></table>
</div>
</div>
When we check whether we have internet connection or not, it is better
to ping an IP address instead of a domain name because pinging a domain
require a <strong>Domain Name System (DNS)</strong> resolution which may not be
possible when we have DNS failure. For example, we can use following
command to check whether we have internet access or not.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ping 4.2.2.4</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h2 id="learning-traceroute-command">Learning traceroute command</h2>
<p>The traceroute command allows us to see which <strong>hops</strong> a packet goes
through before it reaches its destination. By examining the hops we can
determine which one of our network components causes delay or even drops
the packet or has no route to destination address. For example:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> traceroute -n 4.2.2.4
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="se">\#</span> traceroute -n <span class="o">[</span>www.google.com<span class="o">](</span>http://www.google.com/<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div>
We usually use the -n parameter to prevent DNS resolution of
intermediary hops to accelerate the overall process or because we do not
have a DNS server configured for our network or the specific connection
we are examining.</p>
<h1 id="1-listing-network-interfaces">1. Listing network Interfaces</h1>
<p>In this recipe we will see how we can get a complete list of all plumbed
network interfaces using the ifconfig command.</p>
<h2 id="getting-ready">Getting ready</h2>
<p>As we are using a <strong>command line interface</strong> (<strong>CLI</strong>) utility to get
the list of available interfaces we should execute it in the console
environment.</p>
<h2 id="how-to-do-it">How to do it&hellip;</h2>
<p>Following command shows how we can get list of all available interfaces.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig -a</span></span></code></pre></td></tr></table>
</div>
</div>
Following figure shows the output for the above command.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_01.png"
        data-srcset="/post-img/3180_04_01.png, /post-img/3180_04_01.png 1.5x, /post-img/3180_04_01.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_01.png"
        title="/post-img/3180_04_01.png" width="669" height="250" /></p>
<p>As we can see in the figure, the command lists all interfaces including
the <strong>loopback interface</strong> and Ethernet ones. In addition the sample
command we used lists both <strong>IPv4</strong> and <strong>IPv6</strong> enabled interfaces and
separately show their addresses.</p>
<p>OpenSolaris follows a default naming schema for network interfaces it
detects in the system.</p>
<p>Basically all Ethernet interfaces’ names starts with e100 or e1000 as
the prefix and then g to gN as the distinguisher which distinguish each
instance of the installed Ethernet card with another using an integer
number.</p>
<p>All wireless card names are prefixed with wpi followed by a number
indicating the card instance number.</p>
<p><strong>Loopback</strong> interfaces are named with lo and then followed by a
distinguisher number.</p>
<p>There are more schemas for other cards like pcnN, bgeN, switch which we
will discuss in next recipes.</p>
<p>Variety of details might be shown in the flags area depending on the
network interface driver. Some of most important flags are as follow:</p>
<p>The UP flag indicates that interface sends and receives packets.</p>
<p>The NOTRAILERS flag indicates that no trailer included at the end of the
Ethernet frame.</p>
<p>The RUNNING flag indicates that interface is recognized by the kernel.</p>
<p>The MULTICAST flag indicates that the interface supports a multicast
address.</p>
<p>We can change an interface name to a more meaningful and human-readable
name. Detailed instructions about renaming an interface is available at
<a href="http://www.opensolaris.com/use/Migrating.pdf" target="_blank" rel="noopener noreffer ">http://www.opensolaris.com/use/Migrating.pdf</a></p>
<p>The ifconfig command can list the interfaces which are already plumbed
(available for the kernel to use). If an interface is unplumbed, the
command will not show it. We can use dladm command to list all plumbed
and unplumbed interfaces.</p>
<h2 id="how-it-works">How it works&hellip;</h2>
<p>The command reads the network configurations from network configuration
files located at /etc/sysconfig/network-scripts/ and
/etc/hostname.interface_name files or directly from memory when we do
not have any of our interfaces configuration persisted.</p>
<h2 id="theres-more">There&rsquo;s more&hellip;</h2>
<p>The ifconfig command is one of the most useful and handy commands when
we deal with network interfaces and network configuration. A complete
set of its parameters and options is accessible in the man pages or
using the short help format which is as follow
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig --help</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h3 id="getting-information-for-an-specific-network-interface">Getting information for an specific network interface</h3>
<p>If we know our interface name and we want to see its detailed
information we can pass the interface name to ifconfig command. For
example to see detailed information for e1000g0 we can use the following
command.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g0</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h3 id="other-commands-for-listing-network-interfaces">Other commands for listing network interfaces</h3>
<p>We can use some other commands like dladm to list the available network
interfaces. dladm can give more details about an interface including
speed, state and so on. For example the following command shows the
dladm command usage.</p>
<p>The dladm shows both plumbed and unplum-ed interfaces in contrast with
ifconfig which only shows plumbed interfaces.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="post-img/=3180_04_02.png"
        data-srcset="post-img/=3180_04_02.png, post-img/=3180_04_02.png 1.5x, post-img/=3180_04_02.png 2x"
        data-sizes="auto"
        alt="post-img/=3180_04_02.png"
        title="post-img/=3180_04_02.png" /></p>
<h2 id="see-also">See also</h2>
<p>Recipe 2 and recipe three of this chapter discuss how we can configure
the network interface in OpenSolaris. Reading them is recommended to
grasp better understanding of OpenSolaris networking.</p>
<h1 id="2-configuring-a-network-interface-to-obtain-ip-from-a-dhcp-server">2. Configuring a network interface to obtain IP from a DHCP Server</h1>
<p>In chapter 1 recipe we discussed how we can use Network Auto-Magic to
configure automatically configure the network interfaces. Now in this
recipe we will discuss how we can configure the interface manually
without using the NWAM.</p>
<h2 id="getting-ready-1">Getting ready</h2>
<p>To configure a network interface manually we should disable the NWAM
using the following commands.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> svcadm disable network/physical:nwam</span></span></code></pre></td></tr></table>
</div>
</div>
Do not worry if you cannot understand meaning of the two commands.
Simply accept that the svcadm disable the nwam service. In chapter
recipe we will discuss svcadm in more details.</p>
<h2 id="how-to-do-it-1">How to do it&hellip;</h2>
<p>The ifconfig command we discussed in the previous recipe is our tool for
configuring the network interfaces the way we want.</p>
<p>Following command enable the <strong>Dynamic Host Configuration Protocol</strong>
(<strong>DHCP</strong>) client layer for the e1000g0 network card.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g0 dhcp start</span></span></code></pre></td></tr></table>
</div>
</div>
Following figure shows how the new IP address is applied on e1000g0
interface.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_03.png"
        data-srcset="/post-img/3180_04_03.png, /post-img/3180_04_03.png 1.5x, /post-img/3180_04_03.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_03.png"
        title="/post-img/3180_04_03.png" width="650" height="137" /></p>
<p>The command assumes that the interfaces are already plumbed, known to
kernel. If not we should plumb the interface using the following
command:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g0 plumb</span></span></code></pre></td></tr></table>
</div>
</div>
When we configure an interface manually we the configuration will not
survive the reboot unless we make the configuration persistence. To make
the configuration for e1000g0 persistent should create two files in the
file system as follow:</p>
<p>To ask the OS to configure the interface we should create
/etc/hostname.e1000g0. The extension specify the interface we want the
network/physical:default to configure the interface on boot-up.</p>
<p>To ask network/physical:default service to use DHCP to assign an IP
address to this interface we should create /etc/dhcp.e1000g0.</p>
<p>We can create these files using the following command or using normal
text editors like gedit.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> touch /etc/hostname.e1000g0 /etc/dhcp.e1000g0</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h2 id="how-it-works-1">How it works&hellip;</h2>
<p>When we stop the network/physical:nwam service, the OS check whether any
configuration files for each one of the interfaces exists or not, if it
exists OS will configure the interface accordingly and otherwise the
interface will be left un-configured.</p>
<h2 id="theres-more-1">There&rsquo;s more&hellip;</h2>
<p>Sometimes we want to get a new IP address for our interface or we just
do not need the assigned IP anymore and we want to release it to the
pool. Following command release the IP assigned to our interface back to
the pool
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g0 dhcp release</span></span></code></pre></td></tr></table>
</div>
</div>
The command formally send an information packet to DHCP server telling
it that the IP address is no longer required and then stop the DHCP
client. Another way which is not recommended is dropping the IP
addressee without letting the server know that we are not using the
address anymore. The DHCP server will eventually take the address back
into the pool but it will take some times based on the DHCP server
configuration
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g0 dhcp drop</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h2 id="see-also-1">See also</h2>
<p>In the next recipe we will see how we can configure an interface with a
static IP instead of using DHCP. I recommend you review it to get more
information about how network interfaces work in OpenSolaris.</p>
<h1 id="3-configuring-network-interfaces-with-static-ip-address">3. Configuring network interfaces with static IP address</h1>
<p>Sometimes there is no DHCP server around for us to acquire an IP address
from its pool or we just want to use a static IP address for our
interface. Some use cases for static IP address can be the router,
network gateway or our database server.</p>
<h2 id="getting-ready-2">Getting ready</h2>
<ol>
<li>To configure a network interface manually we should disable the NWAM
using the following commands.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> svcadm disable network/physical:nwam</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>Do not worry if you cannot understand meaning of the two commands.
Simply accept that the svcadm disable the nwam service. In chapter
recipe we will discuss svcadm in more details.</li>
</ol>
<h2 id="how-to-do-it-2">How to do it&hellip;</h2>
<p>The ifconfig command we discussed in recipe 1 and recipe 2 of this
chapter provides us with required options to assign a static IP address
to a network interface.</p>
<p>Following command assign 192.168.1.110 to e1000g0 with 255.255.255.0 as
its subnet mask.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g0 inet 192.168.1.110/24</span></span></code></pre></td></tr></table>
</div>
</div>
Before we could use the interface we should bring it up, to bring up the
interface we can use the following command:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g0 inet up</span></span></code></pre></td></tr></table>
</div>
</div>
The IP_Address/Bit_count syntax specifies the IP address we want to
assign to the interface and the number of bits associated with the
subnet mask. In the subnet mask, 24 means that first 24 bits of the
subnet mask should be 1 and the remaining 8 bits should be 1.</p>
<p>Following figure shows how new IP address is assigned to e1000g0
interface.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_04.png"
        data-srcset="/post-img/3180_04_04.png, /post-img/3180_04_04.png 1.5x, /post-img/3180_04_04.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_04.png"
        title="/post-img/3180_04_04.png" width="638" height="140" /></p>
<p>This configuration cannot survive a system reboot unless we persist it
using the network interface declaration files.</p>
<p>To ask the network/physical:default service to configure an interface
using an static IP address we should create
/etc/host_name.interface_name file and place the configuration
information inside it. For example to configure the e1000g0 interface
with the same configuration we used above we should create
/etc/hostname.e1000g0 file and place the following line inside it.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">192.168.1.110/24</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h2 id="how-it-works-2">How it works&hellip;</h2>
<p>When OpenSolaris is booting, the network/physical:default check for any
available file with a known interface as its extension it execute the
ifconfig interface_name inet &lt;each_line_of_the_file&gt; commands
sequentially to configure the interface and finally it executes the
ifconfig interface_name inet up to bring the interface online.</p>
<h2 id="theres-more-2">There&rsquo;s more&hellip;</h2>
<p>To bring down an interface we can use the following command:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig interface_name inet down</span></span></code></pre></td></tr></table>
</div>
</div>
This command takes the interface offline. To remove the persisted
configuration for an interface we should remove the content of its
configuration file or completely remove the corresponding file from the
system.</p>
<h2 id="see-also-2">See also</h2>
<p>First two recipes of this chapter discuss the network interfaces and
using DHCP to configure an interface. We can read them to get more
information about the network interfaces and configuring them.</p>
<h1 id="6-configuring-ftp-server">6. Configuring FTP Server</h1>
<p>The <strong>FTP</strong> (<strong>File Transfer Protocol</strong>) is one of the widely used
services to distribute files publicly. OpenSolaris comes with both FTP
client, ftp command, and FTP server, ftpd daemon. In this recipe we
setup an FTP server and use the ftp command to access the FTP server
content.</p>
<h2 id="getting-ready-3">Getting ready</h2>
<p>We will use a console window or a virtual console to invoke necessary
commands to enable the FTP server. So open the console window by
executing gnome-terminal command in the Run Application (<em>ALT+F2</em>)
window before getting down to business.</p>
<p>We also need to have a ZFS pool available to us, in our sample commands
I used fpool as the practicing pool while you can use any other pool you
have previously created. Creating ZFS pools is discussed in recipe 9 of
chapter 2.</p>
<h2 id="how-to-do-it-3">How to do it&hellip;</h2>
<p>First we should create a file system for the FTP account and shared FTP
content. We can do it using the following commands
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> zfs create fpool/ftp_fs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="se">\#</span> ftpconfig /fpool/ftp_fs</span></span></code></pre></td></tr></table>
</div>
</div>
So far, we shared a file system for our FTP users but we did not specify
which users can access this shared content. The default configuration of
OpenSolaris allows everyone to access the FTP server content using the
anonymous access. Following command the FTP user details.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> grep ftp /etc/passwd</span></span></code></pre></td></tr></table>
</div>
</div>
Now we can enable the FTP service using the following command. FTP
server is managed by SMF as a service available at svc:/network/ftp.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> svcadm <span class="nb">enable</span> ftp</span></span></code></pre></td></tr></table>
</div>
</div>
Following figure shows what we can expect to see when we execute each of
the above commands.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_05.png"
        data-srcset="/post-img/3180_04_05.png, /post-img/3180_04_05.png 1.5x, /post-img/3180_04_05.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_05.png"
        title="/post-img/3180_04_05.png" width="422" height="179" /></p>
<h2 id="how-it-works-3">How it works&hellip;</h2>
<p>Majority of setting up FTP server tasks is automated and the ftpconfig
script is responsible for doing it. What happens when we invoke the
command is summarized below:</p>
<p>A user is created with ftp only access</p>
<p>The script enriches the file system we specified with binary files
required. For example the ls command is copied into the
/fpool/ftp_fs/bin to ensure that FTP user can execute it to get the list
of files.</p>
<p>Later on it write down the configuration required for the FTP service so
when we run the service, clients can access the /fpool/ftp_fs/pub trough
the FTP server.</p>
<p>Following figure shows content of the /fpool/ftp_fs/ which is created by
ftpconfig script.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_06.png"
        data-srcset="/post-img/3180_04_06.png, /post-img/3180_04_06.png 1.5x, /post-img/3180_04_06.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_06.png"
        title="/post-img/3180_04_06.png" width="306" height="141" /></p>
<p>As we can see in the figure, all directories are restricted for the root
access except the pub directory which will contain the files we want to
share over the network.</p>
<h2 id="see-also-3">See also</h2>
<p>Reviewing recipe 10 of this chapter is recommended to see how we can
setup <strong>Secure Shell</strong> (<strong>SSH</strong>) to ensure the data transfer
confidentiality.</p>
<h1 id="7-configuring-dhcp-server-done">7. Configuring DHCP Server ==Done</h1>
<p>A <strong>Dynamic Host Configuration Protocol</strong> (<strong>DHCP</strong>) server leases IP
address to clients connected to the network and has DHCP client enabled
on their network interface.</p>
<h2 id="getting-ready-4">Getting ready</h2>
<p>Before we can setup a start the DHCP server we need to install DHCP
configuration packages. Detail information about installing packages in
provided in recipe of chapter 1. But to save the time we can use the
following command to install the packages.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> pkg install SUNWdhcs</span></span></code></pre></td></tr></table>
</div>
</div>
After installing these packages we can continue with the next step.</p>
<h2 id="how-to-do-it-4">How to do it&hellip;</h2>
<p>First thing to setup the DHCP server is creating the storage and initial
settings for the DHCP server. Following command does the trick for us.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dhcpconfig -D -r SUNWfiles -p /fpool/dhcp_fs -a 10.0.2.254 -d
</span></span><span class="line"><span class="cl">domain.nme -h files -l <span class="m">86400</span></span></span></code></pre></td></tr></table>
</div>
</div>
In the above command we used several parameters and options, each one of
these options are explained below.</p>
<p>The -D specifies that we are setting up a new instance of the DHCP
service.</p>
<p>The -r SUNWfiles specifies the storage type. Here we are using
plain-text storage while SUNWbinfiles and SUNWnisplus are available as
well.</p>
<p>The -p /fpool/dhcp_fs specifies the absolute path to where the
configuration files should be stored.</p>
<p>The -a 10.0.2.15 specifies the DNS server to use on the LAN. We can
multiple comma separated addresses for DNS servers.</p>
<p>The -d domain.nme specifies the network domain name.</p>
<p>The -h files specifies where the host information should be stored.
Other values are nisplus and dns.</p>
<p>The -l 86400 specifies the lease time in seconds.</p>
<p>Now that the initial configuration is created we should proceed to the
next step and create a network.</p>
<p># dhcpconfig -N 10.0.2.0 -m 255.255.255.0 -t 10.0.2.1</p>
<p>Parameters we used in the above command are explained below.</p>
<p>The -N 10.0.2.0 specifies the network address.</p>
<p>The -m 255.255.255.0 specifies the network mask to use for the network</p>
<p>The -t 10.0.2.1 specifies the default gateway</p>
<p>All configurations that we created are stored in DHCP server
configuration files. We can manage the configurations using the dhtadm
command. For example to view all of the current DHCP server
configuration assemblies we can use the following command.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dhtadm -P</span></span></code></pre></td></tr></table>
</div>
</div>
This command’s output is similar to the following figure.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_07.png"
        data-srcset="/post-img/3180_04_07.png, /post-img/3180_04_07.png 1.5x, /post-img/3180_04_07.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_07.png"
        title="/post-img/3180_04_07.png" width="792" height="150" /></p>
<p>Each command we invoked previously is stored as a <strong>macro</strong> with a
unique name in the DHCP configuration storage. Later on we will use
these macros in subsequent commands.</p>
<p>Now we need to create a network of addresses to lease. Following command
adds the addresses we want to lease.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> pntadm -C 10.0.2.0</span></span></code></pre></td></tr></table>
</div>
</div>
If we need to reserve an address for a specific host or a specific
interface in a host we should add the required configuration to the
system to ensure that our host or interface receives the designated IP
address. For example:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> pntadm -A 10.0.2.22 -f MANUAL -i 01001BFC92BC10 -m 10.0.2.0 -y
</span></span><span class="line"><span class="cl">10.0.2.0</span></span></code></pre></td></tr></table>
</div>
</div>
In the above command we have:</p>
<p>The -A 10.0.2.22 adds the IP address 10.0.2.22.</p>
<p>The -f MANUAL sets the flag MANUAL in order to only assign this IP
address to the MAC address specified.</p>
<p>The -i 01001BFC92BC10 sets the MAC address for the host this entry
assigned to it.</p>
<p>The -m 10.0.2.0 specifies that this host is going to use the 192.168.0.0
macro.</p>
<p>The –y asks the command to verify that the macro entered actually
exists.</p>
<p>The 10.0.2.0 Specifies the network the address is assigned to.</p>
<p>Finally we should restart the DHCP server in order for all the changes
to take effect. Following command restarts the corresponding service.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> svcadm restart dhcp-server</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h2 id="how-it-works-4">How it works&hellip;</h2>
<p>When we setup the DHCP service, we store the related configuration in
the storage of our choice. When we start the service, it reads the
configuration from the storage and wait dormant until it receives a
request for leasing an IP address. The service checks the configuration
and if an IP was available for lease, it leases the IP to the client.</p>
<p>Prior to leasing the IP, DHCP service checks all leasing conditions like
leasing a specific IP address to a client to ensure that it leases the
right address to a client.</p>
<h2 id="theres-more-3">There&rsquo;s more&hellip;</h2>
<p>We can use the <strong>DHCP Manager</strong> GUI application to configure a DHCP
server. The DHCP manager can migrate the DHCP storage from one format to
another. To install the DHCP manager package we can use the following
command.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> pkg install SUNWdhcm</span></span></code></pre></td></tr></table>
</div>
</div>
Now we can invoke the DHCP manager using the following command which
opens the DHCP Manager welcome page shown in the following figure.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dhcpmgr</span></span></code></pre></td></tr></table>
</div>
</div>
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_08.png"
        data-srcset="/post-img/3180_04_08.png, /post-img/3180_04_08.png 1.5x, /post-img/3180_04_08.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_08.png"
        title="/post-img/3180_04_08.png" width="386" height="214" /></p>
<h2 id="see-also-4">See also</h2>
<p>Recipe 5, 6 of this chapter recommended understanding IP assignment
better.</p>
<h1 id="8-assigning-multiple-ip-address-to-an-interface">8. Assigning multiple IP address to an interface</h1>
<p>Like other operating system we can assign multiple IP address to a
network interface. This secondary address are called <strong>logical
interfaces</strong> and we can use them to make one machine with one single
network interface own multiple IP addresses for different purposes. We
may need to assign multiple IP address to an interface to make it
available to both internal and external networks or for testing
purposes.</p>
<h2 id="getting-ready-5">Getting ready</h2>
<p>We should have one network interface configured in our system in order
to create additional logical interfaces.</p>
<h2 id="how-to-do-it-5">How to do it&hellip;</h2>
<p>We are going to add a logical interface to e1000g1 interface with a
10.0.2.24 as its static IP address. Before doing so let’s see what
network interface we have using the ifconfig command.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_12.png"
        data-srcset="/post-img/3180_04_12.png, /post-img/3180_04_12.png 1.5x, /post-img/3180_04_12.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_12.png"
        title="/post-img/3180_04_12.png" width="646" height="102" /></p>
<p>Now to add the logical interface we only need to execute the following
command:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g1 addif 10.0.2.24/24 up</span></span></code></pre></td></tr></table>
</div>
</div>
Invoking this command performs the following tasks:</p>
<p>Create a logical interface named e1000g1:1. The naming schema for
logical interfaces conforms with interface_name:logical_interface_number
which the number element can be from 1 to 4096.</p>
<p>Assign 10.0.2.24/24 as its IP address, net mask and broadcast address.</p>
<p>Bring up the interface.</p>
<p>Now if we invoke ifconfing -a command the output should contain the
logical interface status as well. The following figure shows a fragment
of ifconfig -a command.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_13.png"
        data-srcset="/post-img/3180_04_13.png, /post-img/3180_04_13.png 1.5x, /post-img/3180_04_13.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_13.png"
        title="/post-img/3180_04_13.png" width="687" height="145" /></p>
<p>Operating system does not retain this configuration over a system reboot
and to make the configuration persistent we need to make some changes in
the interface configuration file. For example to make the configuration
we applied in this recipe persistent the content of
/etc/opensolaris.e1000g1 should something similar to the following
snippet.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">10.0.2.23/24
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">addif 10.0.2.24/24</span></span></code></pre></td></tr></table>
</div>
</div>
The first line as we discussed in recipe 3 of this chapter assign the
given address to this interface and the second like adds the logical
interface with the given address to this interface.</p>
<p>To remove a logical interface we can simply un-plumb it using the
ifconfig command as shown below.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g1:1 unplumb</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h2 id="how-it-works-5">How it works&hellip;</h2>
<p>When we create a logical interface, OpenSolaris register that interface
in the network and any packet received by the interface will be
delivered to the same stack that handles the underlying physical
interface.</p>
<h2 id="see-also-5">See also</h2>
<p>Reviewing recipe 2 and 3 of this chapter is recommended as they discuss
how to configure a network interface with DHCP or how to manually assign
a static IP address to a network interface.</p>
<p>The next recipe can be another source for learning about Virtual Network
interfaces capability in OpenSolaris which allows us to add network
interfaces to the system using an available physical interface.</p>
<h1 id="9-configuring-virtual-lan-interfaces">9. Configuring virtual LAN interfaces</h1>
<p>Here in this recipe we will see how we can create multiple link layer
virtual interfaces on top a physical network interface.</p>
<p>Each one of the <strong>VLANs</strong> is accessible from outside and we can
configure them to be used in our services and applications. For example,
we can configure our DHCP server to use a <strong>VLAN</strong> or we can run
GlassFish server on it.</p>
<h2 id="getting-ready-6">Getting ready</h2>
<p>Before we can proceed with this recipe we should at least have one
network interface installed in our system.</p>
<h2 id="how-to-do-it-6">How to do it&hellip;</h2>
<p>We can create Virtual Interfaces using dladm command which is the
utility we will use anytime we need to manage some data link layer
entities. Following command shows how we can create a <strong>Virtual LAN
interface</strong> (VLAN).
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dladm create-vlan -l e1000g0 -v <span class="m">1</span> vlan0</span></span></code></pre></td></tr></table>
</div>
</div>
This command creates a VLAN on top of e1000g0 interface with 1
associated as its distinguisher tag. We will discuss distinguisher tags
in more details in how it works section. Following command lists all
available interfaces either configured or not. The shown interfaces
include both virtual and physical interfaces.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dladm show-link</span></span></code></pre></td></tr></table>
</div>
</div>
Now that the vlan0 is created we should plumb it so operating system
detects it. After plumbing we can configure it like any other interface.
We can assign its IP address manually or we can configure it to acquire
an IP address from a DHCP server.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig vlan0 plumb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="se">\#</span> ifconfig vlan0 inet 192.168.1.110/24</span></span></code></pre></td></tr></table>
</div>
</div>
Following figure shows steps the step we described and the system
response to each step.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_09.png"
        data-srcset="/post-img/3180_04_09.png, /post-img/3180_04_09.png 1.5x, /post-img/3180_04_09.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_09.png"
        title="/post-img/3180_04_09.png" width="647" height="254" /></p>
<p>Although the result of dladm command invocations like creating a VLAN is
persisted automatically but the ipconfig commands effect will not
persist unless we use the interface configuration files as discussed in
the recipe 2 and recipe 3 of this chapter.</p>
<p>We can delete a VLAN using delete-vlan subcommand of dladm command as
shown bellow.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dladm delete-vlan vlan0</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h2 id="how-it-works-6">How it works&hellip;</h2>
<p>When we create a VLAN, operating system register its availability and we
can see the interface using dladm command. Each VLAN has a distinguished
numerical tag which we specified it using the -v option along with a
unique name. The name we specified let us to manage and administrate the
interface while the specified tag makes it possible for the OS to
separate packets intended for this interface in the link layer.</p>
<h2 id="see-also-6">See also</h2>
<p>Reviewing recipe 6,5 and 8 in this chapter is recommended to grasp
better understanding of network interfaces and IP address allocation.</p>
<h1 id="10-using-ip-multipathing-and-link-based-failure-detection">10. Using IP multipathing and link based failure detection</h1>
<p>OpenSolaris provides some features to enhance network reliability
including <strong>IP Multipathing</strong>. In IP multipathing multiple network
interfaces installed in the system forms a group of network interfaces
and handles each other’s load when one of them fails.</p>
<p>Each interface in the group can be active or standby, meaning that the
interface is either handling the traffic or it is reserved to get in and
handle the traffic when one of the active interfaces fails.</p>
<p>When we configure a group and we look for network reliability and the
reliability requires that system detect the failed interface and let
another interface handles its load. Two failure detection mechanisms are
supported by OpenSolaris which are as follow:</p>
<p>The <strong>probe based</strong>, <strong>active</strong>, failure detection: In active failure
detection model, OS constantly probe the interface by sending a probe
packet to an exclusive address provided by the interface for failure
detection. If system does not receives a reply for its probe packet the
interface will be considered faulty.</p>
<p>The <strong>link based</strong>, <strong>passive</strong>, failure detection: This model is
supported by network interface driver and is the default model
OpenSolaris uses. In this model the network interface driver set a flag
for the network interface indicating that the interface failed.</p>
<p>In this recipe we configure IPMP group with two active network interface
members using the passive failure detection.</p>
<h2 id="getting-ready-7">Getting ready</h2>
<p>Before we can create an IP multipathing group we should make sure that
we met the following criteria.</p>
<p>Each interface must have a unique MAC address.</p>
<p>Each interface must be configured with a static IP address.</p>
<h2 id="how-to-do-it-7">How to do it&hellip;</h2>
<p>We will use ifconfig utility for our entire configuration as we are
dealing with network layer. In our sample commands we will use e1000g0
and e1000g1 as the two interfaces which form the sm_group.</p>
<p>Fowling figure shows fragment of ifconfig -a command prior to forming
the sm_group.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_10.png"
        data-srcset="/post-img/3180_04_10.png, /post-img/3180_04_10.png 1.5x, /post-img/3180_04_10.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_10.png"
        title="/post-img/3180_04_10.png" width="692" height="106" /></p>
<p>As we can see there is nothing indicating that these interfaces are
member of a group and as specified in the figure we two interfaces uses
static IP addresses.</p>
<p>Following command will make the group and joins the e1000g0 to the
group. One interface can only join one group.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g0 group sm_group</span></span></code></pre></td></tr></table>
</div>
</div>
The first interface joining a group cause the group to be created and
when last interface leave the group, system delete the group afterward.</p>
<p>Following command joins the e1000g1 to the group.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g1 group sm_group</span></span></code></pre></td></tr></table>
</div>
</div>
Now if we check the status of our network interfaces we see a slight
change in the e1000g0 and e1000g1 interface statuses as shown in the
following figure.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_11.png"
        data-srcset="/post-img/3180_04_11.png, /post-img/3180_04_11.png 1.5x, /post-img/3180_04_11.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_11.png"
        title="/post-img/3180_04_11.png" width="683" height="143" /></p>
<p>Like all network configuration we discussed in recipe and 3, the
configuration we just made is not persistent over a reboot and we need
to add some changes in the network interface configuration files to make
the changes persistent on reboot.</p>
<p>In recipe 2 and 3 we discussed how to configure static IP address for an
interface and make that configuration persistent over a reboot using
hostname.interface_name files stored in /etc/ directory.</p>
<p>To make the grouping configuration persistent we just need to add the
group command followed by group_name in the configuration line. For
example to configure the e1000g0 we should have a /etc/hostname.e1000g0
file with the following content:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">10.0.2.21/24 group sm_group</span></span></code></pre></td></tr></table>
</div>
</div>
To remove an interface from a group we just need to invoke grouping
command with no group name. For example to remove e1000g0 from sm_group
we can use the following command:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g0 group “”</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h2 id="how-it-works-7">How it works&hellip;</h2>
<p>When we create a multipathing group, OpenSolaris starts probing all
interfaces by ICMP packets. When an interface fails to respond to the
ICMP packet, the interface RUNNING flag clears and the IP address(es)
assigned to the faulty interface get assigned to either a standby
interface or to an interface with smallest number of IPs.</p>
<h2 id="see-also-7">See also</h2>
<p>Reviewing recipe 2, 3 and 11 in this chapter are recommended to learn
more about networking in OpenSolaris. The IPMP-Tutorial Sneak Preview
available at</p>
<p><a href="http://sun.systemnews.com/articles/144/1/Solaris/22782" target="_blank" rel="noopener noreffer ">http://sun.systemnews.com/articles/144/1/Solaris/22782</a> is recommended
for getting more insight into the IPMP.</p>
<p>More detailed reference is available System Administration Guide: IP
Services located at
<a href="http://docs.sun.com/app/docs/doc/816-4554/ipmptm-1?a=view" target="_blank" rel="noopener noreffer ">http://docs.sun.com/app/docs/doc/816-4554/ipmptm-1?a=view</a></p>
<h1 id="11-configuring-link-aggregation-ethernet-bonding">11. Configuring Link Aggregation (Ethernet bonding)</h1>
<p><strong>Link aggregation</strong> or commonly known <strong>Ethernet bonding</strong> allows us to
enhance the network availability and performance by combining multiple
network interfaces together and form an aggregation of those interfaces
which act as a single network interface with greatly enhanced
availability and performance.</p>
<p>When we aggregate two or more network interfaces, we are forming a new
network interface on top of those physical interfaces combined in the
link layer.</p>
<h2 id="getting-ready-8">Getting ready</h2>
<p>We need to have at least two network interfaces in our machine to create
a link aggregation. The interfaces must be unplumb-ed in order for us to
use them in a link aggregation. Following command shows how to unplumb a
network interface.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig e1000g1 down unplumb</span></span></code></pre></td></tr></table>
</div>
</div>
We should disable the NWAM because link aggregation and NWAM cannot
co-exist.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> svcadm disable network/physical:nwam</span></span></code></pre></td></tr></table>
</div>
</div>
The interfaces we want to use in a link aggregation must not be part of
virtual interface; otherwise it will not be possible to create the
aggregation. To ensure that an interface is not part of a virtual
interface checks the output for the following command.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dladm show-link</span></span></code></pre></td></tr></table>
</div>
</div>
Following figure shows that my e1000g0 has a virtual interface on top of
it so it cannot be used in an aggregation.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_14.png"
        data-srcset="/post-img/3180_04_14.png, /post-img/3180_04_14.png 1.5x, /post-img/3180_04_14.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_14.png"
        title="/post-img/3180_04_14.png" width="408" height="137" /></p>
<p>To delete the virtual interface we can use the dladm command as follow
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dladm delete-vlan vlan0</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h2 id="how-to-do-it-8">How to do it&hellip;</h2>
<p>The link aggregation as the name suggests works in the link layer and
therefore we will use dladm command to make the necessary
configurations. We use create-aggr subcommand of dladm command with the
following syntax to create aggregation links.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dladm create-aggr <span class="se">\[</span>-l interface_name<span class="se">\]\*</span> aggregation_name</span></span></code></pre></td></tr></table>
</div>
</div>
In this syntax we should have at least two occurrence of -l
interface_name option followed by the aggregation name.</p>
<p>Assuming that we have e1000g0 and e1000g1 in our disposal following
commands configure an aggregation link on top of them.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dladm create-aggr -l e1000g0 -l e1000g1 aggr0</span></span></code></pre></td></tr></table>
</div>
</div>
Now that the aggregation is created we can configure its IP allocation
in the same way that we configure a physical or virtual network
interface. Following command plumb the aggr0 interface, assign a static
IP address to it and bring the interface up.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig aggr0 plumb 10.0.2.25/24 up</span></span></code></pre></td></tr></table>
</div>
</div>
Now we can use ifconfig command to see status of our new aggregated
interface.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig aggr0</span></span></code></pre></td></tr></table>
</div>
</div>
The result of the above command should be similar to the following
figure.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_15.png"
        data-srcset="/post-img/3180_04_15.png, /post-img/3180_04_15.png 1.5x, /post-img/3180_04_15.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_15.png"
        title="/post-img/3180_04_15.png" width="610" height="103" /></p>
<p>To get a list of all available network interfaces either virtual or
physical we can use the dladm command as follow
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dladm show-link</span></span></code></pre></td></tr></table>
</div>
</div>
And to get a list of aggregated interfaces we can use another subcommand
of dladm as follow.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dladm show-aggr</span></span></code></pre></td></tr></table>
</div>
</div>
The output for previous dladm commands is shown in the following figure.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/post-img/3180_04_16.png"
        data-srcset="/post-img/3180_04_16.png, /post-img/3180_04_16.png 1.5x, /post-img/3180_04_16.png 2x"
        data-sizes="auto"
        alt="/post-img/3180_04_16.png"
        title="/post-img/3180_04_16.png" width="639" height="189" /></p>
<p>We can change an aggregation link underlying interfaces by adding an
interface to the aggregation or removing one from the aggregation using
add-aggr and remove-aggr subcommands of dladm command. For example:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> dladm add-aggr -l e1000g2 aggr0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="se">\#</span> dladm remove-aggr -l e1000g1 aggr0</span></span></code></pre></td></tr></table>
</div>
</div>
The aggregation we created will survive the reboot but our ifconfig
configuration will not survive a reboot unless we persist it using the
interface configuration files.</p>
<p>To make the aggregation IP configuration persistent we just need to add
create /etc/hostname.aggr0 file with the following content:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">10.0.2.25/24</span></span></code></pre></td></tr></table>
</div>
</div>
The interface configuration files are discussed in recipe 2 and 3 of
this chapter in great details. Reviewing them is recommended.</p>
<p>To delete an aggregation we can use delete-aggr subcommand of dladm
command. For example to delete aggr0 we can use the following commands.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig aggr0 down unplumb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="se">\#</span> dladm delete-aggr aggr0</span></span></code></pre></td></tr></table>
</div>
</div>
As you can see before we could delete the aggregation we should bring
down its interface and unplumb it.</p>
<p>In recipe 11 we discussed IPMP which allows us to have high availability
by grouping network interfaces and when required automatically failing
over the IP address of any failed interface to a healthy one. In this
recipe we saw how we can join a group of interfaces together to have a
better performance. By grouping a set of aggregations we can have the
high availability that IPMP offers along with the performance boost that
link aggregation offers.</p>
<h2 id="how-it-works-8">How it works&hellip;</h2>
<p>The link aggregation works in layer 2 meaning that the aggregation
groups the interfaces in layer 2 of network where network packets are
dealt with. In this layer the network layer’s packets are extracted or
created with the designated IP address of the aggregation and then are
delivered to the lower, higher layer.</p>
<h2 id="see-also-8">See also</h2>
<p>Reviewing recipe 2 and 3 in addition to recipe 8 and 9 is recommended.</p>
<h1 id="12-ip-tunnelling">12. IP tunnelling</h1>
<p>An IP tunnel connects one machine to another over a network without the
two computers being aware of the intermediate network. The most basic
use of IP tunnels is to securely connect two networks through two
endpoint interface over an unreliable network. This use case is called
<strong>Virtual Private Network</strong> (<strong>VPN</strong>).</p>
<p>In OpenSolaris the point to point connection is created using a specific
type of interface called IP Tunnel.</p>
<h2 id="getting-ready-9">Getting ready</h2>
<p>We should have a network connection between the two computers we want to
create the point to point connection. We can use ping command to check
the connectivity between our computers before proceeding with the tunnel
setup.</p>
<h2 id="how-to-do-it-9">How to do it&hellip;</h2>
<p>The IP Tunnel interfaces are configured using ifconfig command.
Following sequence of commands creates a tunnel between 192.168.1.110
which is our local machine and 66.10.12.1 which is the server.</p>
<p>We need to make the interface available to the kernel.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig ip.tun0 plumb</span></span></code></pre></td></tr></table>
</div>
</div>
Now we should configure the tunnel itself. A tunnel has a source and a
destination address at minimum.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig ip.tun0 tsrc 192.168.1.110 tdst 66.10.12.1 thoplimit <span class="m">60</span></span></span></code></pre></td></tr></table>
</div>
</div>
And finally we should bring up the interface.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\#</span> ifconfig ip.tun0 up</span></span></code></pre></td></tr></table>
</div>
</div>
In the second step of creating the tunnel we used several parameters
which are described below.</p>
<p>The ip.tun0 specifies the IP tunnel interface name. The interface name
format is ip.tun# which the digit specifies a 0-4096.</p>
<p>The tsrc 192.168.1.110 specifies the tunnel source or the client machine
IP address. When we are behind firewall we need to adjust the firewall
to let IP protocol 41 packet pass.</p>
<p>The tdst 66.10.12.1 specifies the tunnel destination or server machine.
The destination machine must have the service running so we could
connect to it.</p>
<p>The thoplimit 60 specifies the maximum number of intermediately hops
allowed between the client and the server to form the connection.</p>
<p>We could use one single command to create, configure and bring up the
interface.</p>
<p>ifconfig ip.tun0 plumb ip.tun0 tsrc 192.168.1.110 tdst 66.10.12.1
thoplimit 60 up</p>
<p>We used similar syntax in recipe 11 as well.</p>
<h2 id="see-also-9">See also</h2>
<p>In this recipe we only setup the tunnel between two machines, for two
networks to connect over a tunnel we should define some routing
elements. In chapter 5 recipe # we discuss how we can setup routing
tables.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2010-07-09</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://kalali.blog/2010/07/opensolaris-networking-in-details/" data-title="OpenSolaris Networking In Details" data-via="masoudkalali" data-hashtags="Solaris,Networking,OpenSolaris"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://kalali.blog/2010/07/opensolaris-networking-in-details/" data-hashtag="Solaris"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://kalali.blog/2010/07/opensolaris-networking-in-details/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://kalali.blog/2010/07/opensolaris-networking-in-details/" data-title="OpenSolaris Networking In Details"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://kalali.blog/2010/07/opensolaris-networking-in-details/" data-title="OpenSolaris Networking In Details"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/solaris/">Solaris</a>,&nbsp;<a href="/tags/networking/">Networking</a>,&nbsp;<a href="/tags/opensolaris/">OpenSolaris</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2010/06/introducing-nio-2-jsr-203-part-3-file-system-attributes-and-permissions-support-in-nio-2/" class="prev" rel="prev" title="Introducing NIO.2 (JSR 203) Part 3: File System Attributes and Permissions support in NIO.2"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Introducing NIO.2 (JSR 203) Part 3: File System Attributes and Permissions support in NIO.2</a>
            <a href="/2010/07/managing-and-administrating-opensolaris-zones/" class="next" rel="next" title="Managing and Administrating OpenSolaris Zones">Managing and Administrating OpenSolaris Zones<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2005 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://www.linkedin.com/in/masoudkalali/" target="_blank">Masoud Kalali</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"lightgallery":true,"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', ' UA-137107-12');
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id= UA-137107-12" async></script></body>
</html>
