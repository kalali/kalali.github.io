<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Getting started with CouchDB and MongoDB, Part I: CRUD operations - The Pensieve - Masoud Kalali&#39;s Blog</title><meta name="Description" content="Masoud Kalali&#39;s personal blog. Covering subjects ranging from tech strategy, leadership, software architecture, cloud native, and software development in general."><meta property="og:title" content="Getting started with CouchDB and MongoDB, Part I: CRUD operations" />
<meta property="og:description" content="In a series of blog I am going to write to cover CouchDB and MongoDB as two popular document databases. In each one of the entries I will show how can you do similar tasks with each one of these two so that you get some understanding of the differences and similarities between them. I am not going to do any comparison here but reading the series you can draw conclusion on which one seems more suitable for your case based judging by how different tasks can be accomplished using these two." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kalali.blog/2013/09/2013-09-12-getting-started-with-couchdb-and-mongodb-nosql-document-databases-part-i/" /><meta property="og:image" content="https://kalali.blog/img/avatar.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-09-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2013-09-12T00:00:00+00:00" /><meta property="og:site_name" content="My cool site" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://kalali.blog/img/avatar.jpg"/>

<meta name="twitter:title" content="Getting started with CouchDB and MongoDB, Part I: CRUD operations"/>
<meta name="twitter:description" content="In a series of blog I am going to write to cover CouchDB and MongoDB as two popular document databases. In each one of the entries I will show how can you do similar tasks with each one of these two so that you get some understanding of the differences and similarities between them. I am not going to do any comparison here but reading the series you can draw conclusion on which one seems more suitable for your case based judging by how different tasks can be accomplished using these two."/>
<meta name="application-name" content="The Pensieve - Masoud Kalali&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="The Pensieve - Masoud Kalali&#39;s Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://kalali.blog/2013/09/2013-09-12-getting-started-with-couchdb-and-mongodb-nosql-document-databases-part-i/" /><link rel="prev" href="https://kalali.blog/2011/10/some-thought-on-jsr-351-java-identity-api/" /><link rel="next" href="https://kalali.blog/2013/09/2013-09-17-getting-started-with-couchdb-and-mongodb-part-ii-beginning-with-security/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><meta name="google-site-verification" content="cDJVSx1L3UB6AwrPKeSQszOyhtjHYvPYkDxZw_Me4Z4" /><meta name="msvalidate.01" content="cDJVSx1L3UB6AwrPKeSQszOyhtjHYvPYkDxZw_Me4Z4" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Getting started with CouchDB and MongoDB, Part I: CRUD operations",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/kalali.blog\/2013\/09\/2013-09-12-getting-started-with-couchdb-and-mongodb-nosql-document-databases-part-i\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/kalali.blog\/img\/preview.png",
                            "width":  1027 ,
                            "height":  833 
                        }],"genre": "posts","keywords": "Java, MongoDB, CouchDB","wordcount":  1933 ,
        "url": "https:\/\/kalali.blog\/2013\/09\/2013-09-12-getting-started-with-couchdb-and-mongodb-nosql-document-databases-part-i\/","datePublished": "2013-09-12T00:00:00+00:00","dateModified": "2013-09-12T00:00:00+00:00","license": "This work is licensed under a Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)","publisher": {
            "@type": "Organization",
            "name": "Masoud Kalali"},"author": {
                "@type": "Person",
                "name": "Masoud Kalali"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="auto" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="The Pensieve - Masoud Kalali&#39;s Blog">The Pensieve - Masoud Kalali&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Blog posts"> Posts </a><a class="menu-item" href="/tags/" title="All the blog tags"> Tags </a><a class="menu-item" href="/categories/" title="List of all categories I blogged bout"> Categories </a><a class="menu-item" href="/about/" title="About Masoud Kalali, Author"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="The Pensieve - Masoud Kalali&#39;s Blog">The Pensieve - Masoud Kalali&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="Blog posts">Posts</a><a class="menu-item" href="/tags/" title="All the blog tags">Tags</a><a class="menu-item" href="/categories/" title="List of all categories I blogged bout">Categories</a><a class="menu-item" href="/about/" title="About Masoud Kalali, Author">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Getting started with CouchDB and MongoDB, Part I: CRUD operations</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://www.linkedin.com/in/masoudkalali/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Masoud Kalali</a></span>&nbsp;<span class="post-category">included in <a href="/categories/programming/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Programming</a>&nbsp;<a href="/categories/old-blog-migrated-content/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Old Blog Migrated Content</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2013-09-12">2013-09-12</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1933 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;10 minutes&nbsp;</div>
        </div><div class="content" id="content"><p>In a series of blog I am going to write to cover CouchDB and MongoDB as two popular document databases. In each one of the entries I will show how can you do similar tasks with each one of these two so that you get some understanding of the differences and similarities between them. I am not going to do any comparison here but reading the series you can draw conclusion on which one seems more suitable for your case based judging by how different tasks can be accomplished using these two.</p>
<h3 id="some-technicalities">Some technicalities</h3>
<ul>
<li>All of the source codes for these series is available at <a href="https://github.com/kalali/nosql" target="_blank" rel="noopener noreffer ">https://github.com/kalali/nosql</a> which you can get and run the samples.</li>
<li>All sample codes assume default port numbers unless I mention otherwise in the blog entry itself.</li>
<li>All the blog entries use CouchDB 1.3.1 and MongoDB 2.4.5 and thus I expect them to work fine with this version and any newer ones.</li>
</ul>
<h3 id="a-little-about-these-two-databases">A little about these two databases</h3>
<ul>
<li><strong>MongoDB</strong> and <strong>CouchDB</strong>: Both of them are document databases which lets you store freeform data into the storage in form of a document with key/value fields of data. Just look at JSON to see how a document would look like.</li>
<li><strong>Apache CouchDB</strong>: Provides built-in support for reading/writing JSON documents over a REST interface. Result of a query is JSON and the data you store is in form of JSON all through the HTTP interface. There are tens of access API implemented, each with its own unique characteristics, around the REST interface in different languages which one can use to avoid using the REST interface directly. List of these implementations are available at: <a href="http://wiki.apache.org/couchdb/Related_Projects" target="_blank" rel="noopener noreffer ">Related Projects</a>. Apache CouchDB has more emphasis on availability rather than consistency if you look at it from <a href="http://en.wikipedia.org/wiki/CAP_theorem" target="_blank" rel="noopener noreffer ">CAP theorem</a> perspective. CouchDB is cross platform and developed in ErLang.</li>
<li><strong>MongoDB</strong>: MongoDB does not provide a built-in REST interface to interact with the document store and it does not provide direct support for storing and retrieving JSON documents however it provides a fast native protocol which can be access using the <a href="http://docs.mongodb.org/ecosystem/drivers/" target="_blank" rel="noopener noreffer ">MongoDB Drivers and Client Libraries</a> which are available for almost any language you can think of, and also there are some <a href="http://docs.mongodb.org/ecosystem/tools/http-interfaces/" target="_blank" rel="noopener noreffer ">bridges</a> which one can use to create a REST interface on top of the native interface. MongoDB has more emphasis on consistency rather than availability if you look at it from <a href="http://en.wikipedia.org/wiki/CAP_theorem" target="_blank" rel="noopener noreffer ">CAP theorem</a> perspective. MongoDB is cross platform and developed in C++.</li>
</ul>
<h3 id="downloading-and-starting">Downloading and starting</h3>
<ul>
<li><strong>MongoDB</strong>: You can download MongoDB from  the <a href="http://www.mongodb.org/downloads" target="_blank" rel="noopener noreffer ">download page</a> and after extracting it you can start it by navigating to bin directory and running ./mongo to start the document store. The default administration port is 28017 and the access port number is 27017 by default.</li>
<li><strong>Apache CouchDB</strong>: You can download Apache CouchDB from the <a href="http://couchdb.apache.org/#download" target="_blank" rel="noopener noreffer ">download page</a> or if you are running some Linux distribution you can get it from the package repositories or you can just build it from the code. After installation run <em>sudo couchdb</em> to start the server.</li>
</ul>
<p>The basic scenario for this blog entry is to create a database, add a document, find that document back, update the document and read it back from the store, delete the document and finally to delete the database to make the sample code&rsquo;s execution repeatable.</p>
<p>The CouchDB sample code for the sample scenario:</p>
<p><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span><span class="lnt">97
</span><span class="lnt">98
</span><span class="lnt">99
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.json.JsonObject</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.json.JsonReader</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.ws.rs.core.Response</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.io.StringReader</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.UUID</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="o">*</span>
</span></span><span class="line"><span class="cl"> <span class="err">\</span><span class="o">*</span> <span class="nd">@author</span> <span class="n">Masoud</span> <span class="n">Kalali</span>
</span></span><span class="line"><span class="cl"> <span class="err">\</span><span class="o">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">DB_BASE_URL</span> <span class="o">=</span> <span class="s">&#34;http://127.0.0.1:5984/&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">STORE_NAME</span> <span class="o">=</span> <span class="s">&#34;book_ds&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Client</span> <span class="n">c</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="err">\</span><span class="o">[</span><span class="err">\</span><span class="o">]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">createDocumentStore</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">addingBookToDocumentStore</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">JsonObject</span> <span class="n">secBook</span> <span class="o">=</span> <span class="n">readBook</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">revision</span> <span class="o">=</span> <span class="n">secBook</span><span class="o">.</span><span class="na">getStringValue</span><span class="o">(</span><span class="s">&#34;_rev&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">updateBook</span><span class="o">(</span><span class="n">revision</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">JsonObject</span> <span class="n">secBookAfterUpdate</span> <span class="o">=</span> <span class="n">readBook</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">deleteBookDocument</span><span class="o">(</span><span class="n">secBookAfterUpdate</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">deleteDocumentStore</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">createDocumentStore</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Creating Document Store...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">javax</span><span class="o">.</span><span class="na">ws</span><span class="o">.</span><span class="na">rs</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">Response</span> <span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="n">DB_BASE_URL</span><span class="o">).</span><span class="na">path</span><span class="o">(</span><span class="n">STORE_NAME</span><span class="o">).</span><span class="na">request</span><span class="o">().</span><span class="na">accept</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON_TYPE</span><span class="o">).</span><span class="na">put</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">form</span><span class="o">(</span><span class="k">new</span> <span class="n">Form</span><span class="o">()));</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(!</span><span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getFamily</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">Response</span><span class="o">.</span><span class="na">Status</span><span class="o">.</span><span class="na">Family</span><span class="o">.</span><span class="na">SUCCESSFUL</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;Failed to create document storage: &#34;</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addingBookToDocumentStore</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Library document store created. Adding a book to the library...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">javax</span><span class="o">.</span><span class="na">ws</span><span class="o">.</span><span class="na">rs</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">Response</span> <span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="n">DB_BASE_URL</span><span class="o">).</span><span class="na">path</span><span class="o">(</span><span class="n">STORE_NAME</span><span class="o">).</span><span class="na">path</span><span class="o">(</span><span class="s">&#34;100&#34;</span><span class="o">).</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON_TYPE</span><span class="o">).</span><span class="na">put</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">text</span><span class="o">(</span><span class="s">&#34;{\\n&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;   \\&#34;</span><span class="n">name</span><span class="err">\\</span><span class="s">&#34;: \\&#34;</span><span class="n">GlassFish</span> <span class="n">Security</span><span class="err">\\</span><span class="s">&#34;,\\n&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;   \\&#34;</span><span class="n">author</span><span class="err">\\</span><span class="s">&#34;: \\&#34;</span><span class="n">Masoud</span> <span class="n">Kalali</span><span class="err">\\</span><span class="s">&#34;\\n&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;}&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(!</span><span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getFamily</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">Response</span><span class="o">.</span><span class="na">Status</span><span class="o">.</span><span class="na">Family</span><span class="o">.</span><span class="na">SUCCESSFUL</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;Failed to create book document in the store: &#34;</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">JsonObject</span> <span class="nf">readBook</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Reading the book from the library...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">javax</span><span class="o">.</span><span class="na">ws</span><span class="o">.</span><span class="na">rs</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">Response</span> <span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="n">DB_BASE_URL</span><span class="o">).</span><span class="na">path</span><span class="o">(</span><span class="n">STORE_NAME</span><span class="o">).</span><span class="na">path</span><span class="o">(</span><span class="s">&#34;100&#34;</span><span class="o">).</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON_TYPE</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(!</span><span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getFamily</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">Response</span><span class="o">.</span><span class="na">Status</span><span class="o">.</span><span class="na">Family</span><span class="o">.</span><span class="na">SUCCESSFUL</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;Failed to read the book document from the data store: &#34;</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">ec</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="na">readEntity</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ec</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JsonReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JsonReader</span><span class="o">(</span><span class="k">new</span> <span class="n">StringReader</span><span class="o">(</span><span class="n">ec</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="na">readObject</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">updateBook</span><span class="o">(</span><span class="n">String</span> <span class="n">revision</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Updating the GlassFish Security book...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">javax</span><span class="o">.</span><span class="na">ws</span><span class="o">.</span><span class="na">rs</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">Response</span> <span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="n">DB_BASE_URL</span><span class="o">).</span><span class="na">path</span><span class="o">(</span><span class="n">STORE_NAME</span><span class="o">).</span><span class="na">path</span><span class="o">(</span><span class="s">&#34;100&#34;</span><span class="o">).</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON_TYPE</span><span class="o">).</span><span class="na">put</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">text</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="s">&#34;{\\&#34;</span><span class="n">_rev</span><span class="err">\\</span><span class="s">&#34;:\\&#34;&#34; + revision + &#34;</span><span class="err">\\</span><span class="s">&#34;,\\&#34;</span><span class="n">name</span><span class="err">\\</span><span class="s">&#34;:\\&#34;</span><span class="n">GlassFish</span> <span class="n">Security</span> <span class="n">And</span> <span class="n">Java</span> <span class="n">EE</span> <span class="n">Security</span><span class="err">\\</span><span class="s">&#34;,\\&#34;</span><span class="n">author</span><span class="err">\\</span><span class="s">&#34;:\\&#34;</span><span class="n">Masoud</span> <span class="n">Kalali</span><span class="err">\\</span><span class="s">&#34;}&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(!</span><span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getFamily</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">Response</span><span class="o">.</span><span class="na">Status</span><span class="o">.</span><span class="na">Family</span><span class="o">.</span><span class="na">SUCCESSFUL</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;Failed to update book document in the data store: &#34;</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">deleteBookDocument</span><span class="o">(</span><span class="n">JsonObject</span> <span class="n">secBook</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Deleting the the GlassFish Security book&#39;s document...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">javax</span><span class="o">.</span><span class="na">ws</span><span class="o">.</span><span class="na">rs</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">Response</span> <span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="n">DB_BASE_URL</span><span class="o">).</span><span class="na">path</span><span class="o">(</span><span class="n">STORE_NAME</span><span class="o">).</span><span class="na">path</span><span class="o">(</span><span class="s">&#34;100&#34;</span><span class="o">).</span><span class="na">queryParam</span><span class="o">(</span><span class="s">&#34;rev&#34;</span><span class="o">,</span> <span class="n">secBook</span><span class="o">.</span><span class="na">getStringValue</span><span class="o">(</span><span class="s">&#34;_rev&#34;</span><span class="o">)).</span><span class="na">request</span><span class="o">().</span><span class="na">buildDelete</span><span class="o">().</span><span class="na">invoke</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(!</span><span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getFamily</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">Response</span><span class="o">.</span><span class="na">Status</span><span class="o">.</span><span class="na">Family</span><span class="o">.</span><span class="na">SUCCESSFUL</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;Failed to delete book document in the data store: &#34;</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">deleteDocumentStore</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Deleting the document store...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">javax</span><span class="o">.</span><span class="na">ws</span><span class="o">.</span><span class="na">rs</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">Response</span> <span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="n">DB_BASE_URL</span><span class="o">).</span><span class="na">path</span><span class="o">(</span><span class="n">STORE_NAME</span><span class="o">).</span><span class="na">request</span><span class="o">().</span><span class="na">accept</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON_TYPE</span><span class="o">).</span><span class="na">delete</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(!</span><span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getFamily</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">Response</span><span class="o">.</span><span class="na">Status</span><span class="o">.</span><span class="na">Family</span><span class="o">.</span><span class="na">SUCCESSFUL</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;Failed to delete document storage: &#34;</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">getStatusInfo</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
I used JAX-RS and Some JSON-P in the code to add some salt to it rather than using plan http connection and plain-text content, but that aside the most important thing that you may want to remember is that we are using HTTP verbs for different actions, for example, PUT to create, DELETE to delete, POST to update and GET to query and read. The other important factor that you may have noticed is the _rev or the revision attribute of the document. You see that in order to update the document I specified the revision string, _rev in the document, also to delete the document I use the _rev id. This is required because at each point in time there might be multiple revisions of the document living in the database and you may read an older revision and that is the revision you can update (you can update a document revision because someone else might have updated the document while you were doing the update and thus your revision is old and you are updating your own revision). The POM file for the couchDB sample is as follow:</p>
<p><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"> 4.0.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    me.kalali.couchdb
</span></span><span class="line"><span class="cl">    couchdb_ch01
</span></span><span class="line"><span class="cl">    1.0-SNAPSHOT
</span></span><span class="line"><span class="cl">    jar
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    couchdb_ch01
</span></span><span class="line"><span class="cl">    http://maven.apache.org
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    UTF-8 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    org.glassfish.jersey.media
</span></span><span class="line"><span class="cl">            jersey-media-moxy
</span></span><span class="line"><span class="cl">            2.2 
</span></span><span class="line"><span class="cl">        org.glassfish.jersey.core
</span></span><span class="line"><span class="cl">            jersey-client
</span></span><span class="line"><span class="cl">            2.2 
</span></span><span class="line"><span class="cl">        org.glassfish
</span></span><span class="line"><span class="cl">            javax.json
</span></span><span class="line"><span class="cl">            1.0-b02 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    org.codehaus.mojo
</span></span><span class="line"><span class="cl">                exec-maven-plugin
</span></span><span class="line"><span class="cl">                1.2.1
</span></span><span class="line"><span class="cl">                run-main
</span></span><span class="line"><span class="cl">                        package
</span></span><span class="line"><span class="cl">                        java 
</span></span><span class="line"><span class="cl">                me.kalali.couchdb.ch01.App </span></span></code></pre></td></tr></table>
</div>
</div>
Now, doing a clean install for the CouchDB project sample we get:</p>
<p>Creating Document Store&hellip;
Library document store created. Adding a book to the library&hellip;
Reading the book back from the library&hellip;
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;_id&#34;</span><span class="p">:</span><span class="s2">&#34;100&#34;</span><span class="p">,</span><span class="nt">&#34;_rev&#34;</span><span class="p">:</span><span class="s2">&#34;1-99fb78c8607deb8ff966e2e2b3f3f7b3&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;GlassFish Security&#34;</span><span class="p">,</span><span class="nt">&#34;author&#34;</span><span class="p">:</span><span class="s2">&#34;Masoud Kalali&#34;</span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
Updating the GlassFish Security book&hellip;
Book details after update:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;_id&#34;</span><span class="p">:</span><span class="s2">&#34;100&#34;</span><span class="p">,</span><span class="nt">&#34;_rev&#34;</span><span class="p">:</span><span class="s2">&#34;2-27c86bc501856c8bbe301b5a27f8da02&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;GlassFish Security And Java EE Security&#34;</span><span class="p">,</span><span class="nt">&#34;author&#34;</span><span class="p">:</span><span class="s2">&#34;Masoud Kalali&#34;</span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
Deleting the the GlassFish Security book&rsquo;s document&hellip;
Deleting the document store&hellip;</p>
<p>If you pay attention you see that the _rev attribute has changed after updating the document, that is because by default read operation reads the latest revision of the document and in the second read after we updated the document the revision is changed and document that is read is the latest revision.</p>
<h3 id="the-mongodb-code-for-the-sample-scenario">The MongoDB code for the sample scenario</h3>
<p><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.mongodb.BasicDBObject</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.mongodb.DB</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.mongodb.DBCollection</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.mongodb.DBObject</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.mongodb.MongoClient</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.mongodb.WriteResult</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.net.UnknownHostException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="o">*</span>
</span></span><span class="line"><span class="cl"> <span class="err">\</span><span class="o">*</span> <span class="nd">@author</span> <span class="n">Masoud</span> <span class="n">Kalali</span>
</span></span><span class="line"><span class="cl"> <span class="err">\</span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">STORE_NAME</span> <span class="o">=</span> <span class="s">&#34;book_ds&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">MongoClient</span> <span class="n">mongoClient</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="err">\</span><span class="o">[</span><span class="err">\</span><span class="o">]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">UnknownHostException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">mongoClient</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MongoClient</span><span class="o">(</span><span class="s">&#34;127.0.0.1&#34;</span><span class="o">,</span> <span class="mi">27017</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">DBCollection</span> <span class="n">collection</span> <span class="o">=</span> <span class="n">createDocumentStore</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">addBookToCollection</span><span class="o">(</span><span class="n">collection</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">DBObject</span> <span class="n">secBook</span> <span class="o">=</span> <span class="n">readBook</span><span class="o">(</span><span class="n">collection</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Book details read from document store: \\n&#34;</span> <span class="o">+</span> <span class="n">secBook</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">updateBook</span><span class="o">(</span><span class="n">collection</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">DBObject</span> <span class="n">secBookAfterUpdate</span> <span class="o">=</span> <span class="n">readBook</span><span class="o">(</span><span class="n">collection</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Book details after update: \\n&#34;</span> <span class="o">+</span> <span class="n">secBookAfterUpdate</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">deleteBookDocument</span><span class="o">(</span><span class="n">collection</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">deleteDocumentStore</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">DBCollection</span> <span class="nf">createDocumentStore</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Creating Document Store...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">DB</span> <span class="n">db</span> <span class="o">=</span> <span class="n">mongoClient</span><span class="o">.</span><span class="na">getDB</span><span class="o">(</span><span class="n">STORE_NAME</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">DBCollection</span> <span class="n">collection</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="na">getCollection</span><span class="o">(</span><span class="s">&#34;books&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">collection</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addBookToCollection</span><span class="o">(</span><span class="n">DBCollection</span> <span class="n">collection</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Library document store created. Adding a book to the library...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">DBObject</span> <span class="n">object</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BasicDBObject</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">object</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="s">&#34;GlassFish Security&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">object</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;_id&#34;</span><span class="o">,</span> <span class="s">&#34;100&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">object</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;author&#34;</span><span class="o">,</span> <span class="s">&#34;Masoud Kalali&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">collection</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">object</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">DBObject</span> <span class="nf">readBook</span><span class="o">(</span><span class="n">DBCollection</span> <span class="n">collection</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">DBObject</span> <span class="n">secBook</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BasicDBObject</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">secBook</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;_id&#34;</span><span class="o">,</span> <span class="s">&#34;100&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">collection</span><span class="o">.</span><span class="na">findOne</span><span class="o">(</span><span class="n">secBook</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">updateBook</span><span class="o">(</span><span class="n">DBCollection</span> <span class="n">collection</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Updating the GlassFish Security book...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">DBObject</span> <span class="n">matchings</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="na">findOne</span><span class="o">(</span><span class="k">new</span> <span class="n">BasicDBObject</span><span class="o">(</span><span class="s">&#34;_id&#34;</span><span class="o">,</span> <span class="s">&#34;100&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">DBObject</span> <span class="n">updateStmt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BasicDBObject</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">updateStmt</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="s">&#34;GlassFish Security And Java EE Security&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">updateStmt</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;_id&#34;</span><span class="o">,</span> <span class="s">&#34;100&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">updateStmt</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;author&#34;</span><span class="o">,</span> <span class="s">&#34;Masoud Kalali&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">WriteResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">matchings</span><span class="o">,</span> <span class="n">updateStmt</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Updated documents count: &#34;</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="na">getN</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">deleteBookDocument</span><span class="o">(</span><span class="n">DBCollection</span> <span class="n">collection</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">DBObject</span> <span class="n">object</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BasicDBObject</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">object</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;_id&#34;</span><span class="o">,</span> <span class="s">&#34;100&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">WriteResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">object</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Deleted documents count: &#34;</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="na">getN</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">deleteDocumentStore</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Deleting the document store...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">mongoClient</span><span class="o">.</span><span class="na">dropDatabase</span><span class="o">(</span><span class="n">STORE_NAME</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
As you can see in the code we are using the Mongo API rather than using direct HTTP communication and that is because MongoDB does not provide a built-in REST interface but rather it has its own native protocol as explained above. The other important part which will be in comparison with CouchDB is absence of revision or _rev or an attribute with similar semantic role. That is because MongoDB does not keep multiple version of the document Look at <a href="http://en.wikipedia.org/wiki/CAP_theorem" target="_blank" rel="noopener noreffer ">CAP theorem</a> for more information on consistency and availability attributes of these two databases. Now, the POM file for the MongoDB sample is as follow:</p>
<p><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">4.0.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   me.kalali.mongodb
</span></span><span class="line"><span class="cl">   mongodb_ch01
</span></span><span class="line"><span class="cl">   1.0-SNAPSHOT
</span></span><span class="line"><span class="cl">   jar
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   mongodb_ch01
</span></span><span class="line"><span class="cl">   http://maven.apache.org
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   UTF-8 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   org.mongodb
</span></span><span class="line"><span class="cl">           mongo-java-driver
</span></span><span class="line"><span class="cl">           2.10.1 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   org.codehaus.mojo
</span></span><span class="line"><span class="cl">               exec-maven-plugin
</span></span><span class="line"><span class="cl">               1.2.1
</span></span><span class="line"><span class="cl">               run-main
</span></span><span class="line"><span class="cl">                       package
</span></span><span class="line"><span class="cl">                       java 
</span></span><span class="line"><span class="cl">               me.kalali.mongodb.ch01.App </span></span></code></pre></td></tr></table>
</div>
</div>
The output for doing a <em>clean install</em> on the MongoDB sample will be as shown below:</p>
<p>Creating Document Store&hellip;
Library document store created. Adding a book to the library&hellip;
Book details read from document store:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;100&#34;</span> <span class="p">,</span> <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;GlassFish Security&#34;</span> <span class="p">,</span> <span class="nt">&#34;author&#34;</span> <span class="p">:</span> <span class="s2">&#34;Masoud Kalali&#34;</span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
Updating the GlassFish Security book&hellip;
Updated documents count: 1
Book details after update:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;100&#34;</span> <span class="p">,</span> <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;GlassFish Security And Java EE Security&#34;</span> <span class="p">,</span> <span class="nt">&#34;author&#34;</span> <span class="p">:</span> <span class="s2">&#34;Masoud Kalali&#34;</span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
Deleting the the GlassFish Security book&rsquo;s document&hellip;
Deleting the document store&hellip;</p>
<p>The sample code for this blog entry is available at <a href="https://github.com/kalali/nosql/" target="_blank" rel="noopener noreffer ">GutHub:Kalali</a></p>
<p>This blog entry is wrote based on CouchDB 1.3.1 and MongoDB 2.4.5 and thus the descriptions are valid for these versions and they may differ in other versions. The sample codes should work with the mentioned versions and any newer release.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2013-09-12</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://kalali.blog/2013/09/2013-09-12-getting-started-with-couchdb-and-mongodb-nosql-document-databases-part-i/" data-title="Getting started with CouchDB and MongoDB, Part I: CRUD operations" data-via="masoudkalali" data-hashtags="Java,MongoDB,CouchDB"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://kalali.blog/2013/09/2013-09-12-getting-started-with-couchdb-and-mongodb-nosql-document-databases-part-i/" data-hashtag="Java"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://kalali.blog/2013/09/2013-09-12-getting-started-with-couchdb-and-mongodb-nosql-document-databases-part-i/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://kalali.blog/2013/09/2013-09-12-getting-started-with-couchdb-and-mongodb-nosql-document-databases-part-i/" data-title="Getting started with CouchDB and MongoDB, Part I: CRUD operations"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://kalali.blog/2013/09/2013-09-12-getting-started-with-couchdb-and-mongodb-nosql-document-databases-part-i/" data-title="Getting started with CouchDB and MongoDB, Part I: CRUD operations"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/java/">Java</a>,&nbsp;<a href="/tags/mongodb/">MongoDB</a>,&nbsp;<a href="/tags/couchdb/">CouchDB</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2011/10/some-thought-on-jsr-351-java-identity-api/" class="prev" rel="prev" title="My thoughts on JSR 351, Java Identity API"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>My thoughts on JSR 351, Java Identity API</a>
            <a href="/2013/09/2013-09-17-getting-started-with-couchdb-and-mongodb-part-ii-beginning-with-security/" class="next" rel="next" title="Getting started with CouchDB and MongoDB, Part II: Beginning with Security">Getting started with CouchDB and MongoDB, Part II: Beginning with Security<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2005 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://www.linkedin.com/in/masoudkalali/" target="_blank">Masoud Kalali</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"lightgallery":true,"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', ' UA-137107-12');
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id= UA-137107-12" async></script></body>
</html>
